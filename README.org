* [[file:/ssh:kaipada@192.168.0.10:~/][thaNAS]]

#+CAPTION: Purple bad guy saying I am inevitable
#+html: <p align="center"><img src="fluff/MrPurple.gif" /></p>

Home NAS / Plex media server setup

** Setting up ansible

#+begin_src sh
pip install ansible
pip install passlib
#+end_src

Set up the server list to play on
file:./ansible_hosts.conf

Check inventory after setting up file
#+begin_src sh
sudo mkdir /etc/ansible
sudo ln -s ~/Repos/Notes/thaNAS/ansible_hosts.conf /etc/ansible/hosts
ansible-inventory --list -y

# or specify inventory
ansible-inventory -i ansible_hosts.conf --list -y
#+end_src

** Test connection

Add public key to the server as root and then test out connection

Tries to ssh as root in this case
#+begin_src sh
ansible all -m ping -u root
#+end_src

** Vault to store passwords

file:ansible_vault_password.txt --> vault password
file:ansible_vault.yml --> Put passwords here

#+begin_src sh
cd ~/Repos/thaNAS/
ansible-vault create ansible_vault.yml
ansible-vault decrypt --vault-password-file=ansible_vault_password.txt ansible_vault.yml
ansible-vault encrypt --vault-password-file=ansible_vault_password.txt ansible_vault.yml
#+end_src

** Execute the playbook

#+begin_src sh
ansible-playbook setup_thaNAS_playbook.yml -i ansible_hosts.conf --list-tasks --vault-pass-file ansible_vault_password.txt
ansible-playbook setup_thaNAS_playbook.yml -i ansible_hosts.conf -u root --vault-pass-file ansible_vault_password.txt # execute
#+end_src
